(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{10355:(e,t,n)=>{"use strict";n.d(t,{default:()=>$});var a=n(95155),s=n(12115),r=n(51362),l=n(83415),i=n(87017),d=n(26715),o=n(63439),u=n(56774),p=n(29803),c=n(99621),m=n(20482),y=n(66766),x=n(6874),h=n.n(x),b=n(35695),f=n(11266),w=n(69598),g=n(15650),v=n(75218),T=n(2145),j=n(7569),S=n(68183),N=n(76149),F=n(38227),k=n(32064),B=n(33771),D=n(11580),O=n(23091),A=n(71174),E=n(62774),C=n(23726),G=n(4399),U=n(73703),M=n(77837),R=n(13568);async function I(e){let{txhash:t="",userOpHash:n="",useraddress:a,token:s,amount:r,direction:l,status:i,notes:d=null,chainstatus:o,processedat:u=null,contractaddress:p="",calldata:c="",blockNumber:m=null,gasUsed:y=null,receiptHash:x="",signature:h="",gaslimit:b=BigInt(0),nonce:f=BigInt(0)}=e;return fetch("/api/queue/swap",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({txhash:t,userOpHash:n,useraddress:a,fromtoken:"toGBD"===l?s:"GBD",totoken:"toGBD"===l?"GBD":s,amountin:r,amountout:0,status:i,chainstatus:o,timestamp:new Date().toISOString(),queuedat:new Date().toISOString(),processedat:u,priority:1,retrycount:0,notes:d,contractaddress:p,calldata:c,blockNumber:m,gasUsed:y,receiptHash:x,signature:h,gaslimit:b,nonce:f})})}var P=n(75494);let H=JSON.parse('{"H":[{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"previousAdmin","type":"address"},{"indexed":false,"internalType":"address","name":"newAdmin","type":"address"}],"name":"AdminChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"beacon","type":"address"}],"name":"BeaconUpgraded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"newFeeBps","type":"uint256"}],"name":"FeeUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint8","name":"version","type":"uint8"}],"name":"Initialized","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":true,"internalType":"address","name":"stable","type":"address"},{"indexed":false,"internalType":"uint256","name":"gbdIn","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"stableOut","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"fee","type":"uint256"}],"name":"StableRefunded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":true,"internalType":"address","name":"stable","type":"address"},{"indexed":false,"internalType":"uint256","name":"stableIn","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"gbdOut","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"fee","type":"uint256"}],"name":"StableSwapped","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"implementation","type":"address"}],"name":"Upgraded","type":"event"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserSwaps","outputs":[{"components":[{"internalType":"address","name":"fromToken","type":"address"},{"internalType":"address","name":"toToken","type":"address"},{"internalType":"uint128","name":"fromAmount","type":"uint128"},{"internalType":"uint128","name":"toAmount","type":"uint128"},{"internalType":"uint64","name":"fee","type":"uint64"},{"internalType":"uint32","name":"timestamp","type":"uint32"},{"internalType":"uint8","name":"status","type":"uint8"}],"internalType":"struct StableSwapLib.SwapRecord[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint8","name":"status","type":"uint8"}],"name":"getUserSwapsByStatus","outputs":[{"components":[{"internalType":"address","name":"fromToken","type":"address"},{"internalType":"address","name":"toToken","type":"address"},{"internalType":"uint128","name":"fromAmount","type":"uint128"},{"internalType":"uint128","name":"toAmount","type":"uint128"},{"internalType":"uint64","name":"fee","type":"uint64"},{"internalType":"uint32","name":"timestamp","type":"uint32"},{"internalType":"uint8","name":"status","type":"uint8"}],"internalType":"struct StableSwapLib.SwapRecord[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_owner","type":"address"},{"internalType":"address","name":"_gbd","type":"address"},{"internalType":"address[]","name":"initialStables","type":"address[]"},{"internalType":"uint256","name":"initialFeeBps","type":"uint256"}],"name":"initialize","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"proxiableUUID","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"newFeeBps","type":"uint256"}],"name":"setFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"stable","type":"address"},{"internalType":"uint256","name":"gbdAmount","type":"uint256"}],"name":"swapGBDForStable","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"stable","type":"address"},{"internalType":"uint128","name":"amount","type":"uint128"}],"name":"swapStableForGBD","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"stable","type":"address"},{"internalType":"bool","name":"isEnabled","type":"bool"}],"name":"toggleStablecoin","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newImplementation","type":"address"}],"name":"upgradeTo","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newImplementation","type":"address"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"upgradeToAndCall","outputs":[],"stateMutability":"payable","type":"function"}]}');var _=n(8777),W=n(21571);let L=e=>{let{openWalletModal:t}=e,{address:n,isConnected:r}=(0,T.F)(),{data:l}=(0,j.G)(),{chain:i}=(0,T.F)(),d=null==i?void 0:i.id,{writeContractAsync:o}=(0,S.x)(),{connect:u,connectors:p}=(0,N.e)(),[c,y]=(0,s.useState)(""),[x,h]=(0,s.useState)("toGBD"),[b,f]=(0,s.useState)(B.L[1]),[w,g]=(0,s.useState)("0.0");(0,F.l)({chain:D.J,transport:(0,k.L)()});let{smartAccountClient:v}=(0,W.y)(),[L,J]=(0,s.useState)(null);return(0,s.useEffect)(()=>{(async()=>{var e;let t=await v;if(!t)return;let{handleSwap:a}=(e={address:null!=n?n:"",chainId:null!=d?d:0,amount:c,selectedToken:b,direction:x,smartAccountClient:t},{handleSwap:async()=>{var t,n,a,s,r,l,i;let{address:d="",chainId:o=0,selectedToken:u={},amount:p="",direction:c,smartAccountClient:m}=e,y=new Date().toISOString(),x="",h="",b=!0;if(!d||!o||!m||!c||!u.address||!u.decimals)return void R.oR.error("Swap unavailable — wallet or config incomplete.");try{let e,l=new E.k(window.ethereum),i=C.XS(p,u.decimals);new G.NZ(u.address,P.HV,l);let o=new G.NZ(O.WGBD,P.HV,l),f=O.StableSwapGateway,w=new U.KA(H.H);if("toGBD"===c)e=w.encodeFunctionData("swapStableForGBD",[u.address,i]);else{let t=await o.balanceOf(d),n=await l.getBalance(d);if(t<i&&n>=i){let e=await o.deposit({value:i});await e.wait()}e=w.encodeFunctionData("swapGBDForStable",[u.address,i])}let g={to:f,data:e,value:0n},v=await m.buildUserOp(g),T=await m.estimateUserOpGas(v),j=await m.getNonce(),S=await m.buildUserOp(g,{gasLimit:T,nonce:j}),N=await m.signUserOp(S),F=M.c$(N.signature);h=await m.getUserOpHash(N);try{let e=await l.getNetwork();if(!(null==e?void 0:e.chainId))throw Error("RPC unhealthy")}catch(e){b=!1}if(!b){await I({txhash:"",userOpHash:h,useraddress:d,token:null!=(t=u.symbol)?t:"unknown",amount:parseFloat(p),direction:c,processedat:y,status:"queued",chainstatus:!1,contractaddress:f,calldata:e,signature:F,gaslimit:T,nonce:j,receiptHash:"",blockNumber:null,gasUsed:null,notes:"RPC unavailable — swap intent captured"}),R.oR.error("Chain unavailable. Swap queued for retry.");return}let k=await m.sendSignedUserOp(N),B=await k.waitFortxhash();x=null!=(n=null==B?void 0:B.transactionHash)?n:"";let D=await l.getTransactionReceipt(x),A=null!=(a=null==D?void 0:D.blockNumber)?a:null,W=null!=(s=null==D?void 0:D.gasUsed)?s:null,L=(0,_.createHash)("sha256").update(JSON.stringify(D)).digest("hex");await I({txhash:x,userOpHash:h,useraddress:d,token:null!=(r=u.symbol)?r:"unknown",amount:parseFloat(p),direction:c,processedat:y,status:"finalized",chainstatus:!0,contractaddress:f,calldata:e,signature:F,gaslimit:T,nonce:j,blockNumber:A,gasUsed:W,receiptHash:L}),R.oR.success("Swap finalized successfully!")}catch(e){console.warn("Swap error:",e),await I({txhash:"",userOpHash:h,useraddress:d,token:null!=(l=u.symbol)?l:"unknown",amount:parseFloat(p),direction:c,processedat:y,status:"failed",chainstatus:!1,contractaddress:O.StableSwapGateway,calldata:"",signature:"",gaslimit:BigInt(0),nonce:BigInt(0),receiptHash:"",blockNumber:null,gasUsed:null,notes:null!=(i=e.message)?i:"Unknown swap error"}),R.oR.error("Swap failed — check logs or try again.")}}});J(()=>a)})()},[n,d,c,b,x,v]),(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center text-center p-6 max-w-md mx-auto",children:[(0,a.jsx)("h2",{className:"text-xl font-light mb-4",children:"TOKEN SWAP"}),(0,a.jsx)("label",{className:"w-full text-left text-sm mt-6 mb-3",children:"SELECT TOKEN"}),(0,a.jsx)("select",{className:"select select-bordered w-full mb-4",value:b.symbol,onChange:e=>f(B.L.find(t=>t.symbol===e.target.value)||B.L[1]),children:B.L.filter(e=>"GBDO"!==e.symbol).map(e=>(0,a.jsxs)("option",{value:e.symbol,children:[e.name," (",e.symbol,")"]},e.symbol))}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-1 w-full",children:[(0,a.jsx)("label",{className:"text-left text-sm w-1/2",children:"AMOUNT"}),(0,a.jsxs)("p",{className:"text-sm text-gray-400 text-right w-1/2",children:["Balance: ",parseFloat(w).toFixed(4)]})]}),(0,a.jsx)("input",{type:"text",inputMode:"decimal",pattern:"[0-9]*",value:c,onChange:e=>y(e.target.value),className:"input input-bordered w-full",placeholder:"0.0"}),(0,a.jsxs)("div",{className:"flex justify-between gap-2 mt-6 w-full",children:[(0,a.jsx)("button",{className:"flex items-center justify-center ".concat("toGBD"===x?"bg-primary/15 h-8 text-white text-xs rounded-full px-4 py-2":"bg-secondary rounded-full h-8 text-xs text-white px-4 py-2"),onClick:()=>h("toGBD"),children:"To GBD"}),(0,a.jsx)("button",{className:"flex items-center justify-center ".concat("fromGBD"===x?"bg-primary/15 h-8 text-white text-xs rounded-full px-4 py-2":"bg-secondary rounded-full h-8 text-xs text-white px-4 py-2"),onClick:()=>h("fromGBD"),children:"From GBD"})]}),(0,a.jsxs)("div",{className:"flex justify-between gap-12 mt-10 p-4 border-t w-full bg-transparent",children:[(0,a.jsxs)("div",{className:"flex flex-col w-1/2 items-start",children:[(0,a.jsx)(m.g_,{}),!n&&(0,a.jsx)("span",{className:"text-red-500 text-xs mt-2",children:"    Wallet required"})]}),(0,a.jsx)("div",{className:"flex flex-col w-1/2 items-start",children:(0,a.jsxs)("button",{className:"bg-primary/60 text-base-200 text-xs rounded-full px-4 py-2 h-10 flex items-center gap-2 disabled:opacity-50",onClick:null!=L?L:void 0,disabled:!c||0>=parseFloat(c)||!n||!d,children:[(0,a.jsx)(A.A,{className:"h-5 w-4 shrink-0"}),"toGBD"===x?"Swap to GBD":"Swap to Stable"]})})]})]})};var J=n(15381),q=n(73146);let z=[],V=()=>{let e=(0,b.usePathname)();return(0,a.jsx)(a.Fragment,{children:z.map(t=>{let{label:n,href:s,icon:r}=t,l=e===s;return(0,a.jsx)("li",{children:(0,a.jsxs)(h(),{href:s,className:"".concat(l?"bg-secondary shadow-md":""," hover:bg-secondary hover:shadow-md focus:!bg-secondary active:!text-neutral py-1.5 px-3 text-sm rounded-full gap-2 grid grid-flow-col"),children:[r,(0,a.jsx)("span",{children:n})]})},s)})})},K=()=>{let{targetNetwork:e}=(0,g.x)();e.id,f.H.id;let t=(0,b.usePathname)(),n=(null==t?void 0:t.startsWith("/dashboard"))||"/"===t,r=(0,s.useRef)(null);(0,g.jz)(r,()=>{var e;null==r||null==(e=r.current)||e.removeAttribute("open")});let[l,i]=(0,s.useState)(!1),[d,o]=(0,s.useState)(!1),[u,p]=(0,s.useState)(!1),[c,x]=(0,s.useState)(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"sticky lg:static top-0 navbar bg-black min-h-0 shrink-0 justify-between z-20 shadow-md shadow-black px-0 sm:px-2",children:[(0,a.jsxs)("div",{className:"navbar-start w-auto lg:w-1/2",children:[(0,a.jsxs)("details",{className:"dropdown",ref:r,children:[(0,a.jsx)("summary",{className:"ml-1 btn btn-ghost py-4 lg:hidden hover:bg-secondary",children:(0,a.jsx)(w.A,{className:"h-1/2"})}),(0,a.jsxs)("ul",{className:"menu menu-compact dropdown-content mt-3 p-2 shadow-sm bg-grey rounded-box w-52",onClick:()=>{var e;null==r||null==(e=r.current)||e.removeAttribute("open")},children:[(0,a.jsx)("li",{children:(0,a.jsx)(h(),{href:n?"/storefront":"/dashboard",children:(0,a.jsx)("button",{className:"btn btn-sm btn-base-100 border-none font-light focus-none outline-none w-full hover:bg-base-300",children:n?"Go to STOREFRONT":"Go to DASHBOARD"})})}),(0,a.jsx)(V,{})]})]}),(0,a.jsx)("ul",{className:"hidden lg:flex items-center gap-2 ml-4 mr-6 shrink-0",children:(0,a.jsx)("div",{className:"flex relative w-10 h-10",children:(0,a.jsx)(h(),{href:n?"/dashboard":"/storefront",children:(0,a.jsx)(y.default,{alt:"SE2 logo",fill:!0,src:"/logo.svg",className:"cursor-pointer"})})})}),(0,a.jsxs)("ul",{className:"hidden lg:flex lg:flex-nowrap menu menu-horizontal px-1 gap-2",children:[(0,a.jsx)("li",{children:(0,a.jsx)(h(),{href:n?"/storefront":"/dashboard",children:(0,a.jsx)("button",{className:"btn btn-sm btn-base-100 border-none font-light focus-none outline-none hover:bg-base-300",children:n?"Go to STOREFRONT":"Go to DASHBOARD"})})}),(0,a.jsx)(V,{})]})]}),(0,a.jsxs)("div",{className:"navbar-end grow mr-4 flex items-center gap-4",children:[(0,a.jsx)(m.g_,{}),(0,a.jsx)("button",{onClick:()=>i(!0),className:"text-xs font-light text-white hover:text-primary transition bg-transparent border-none focus:outline-none",children:"SWAP"}),(0,a.jsx)("button",{onClick:()=>o(!0),className:"text-xs font-light text-white hover:text-primary transition bg-transparent border-none focus:outline-none",children:"TRANSFER"}),(0,a.jsxs)("nav",{className:"hidden lg:flex gap-6 text-xs font-light",children:[(0,a.jsx)(h(),{href:"/about",target:"_blank",rel:"noopener noreferrer",className:"hover:text-primary transition",children:"ABOUT"}),(0,a.jsx)(h(),{href:"/whitepaper",target:"_blank",rel:"noopener noreferrer",className:"hover:text-primary transition",children:"WHITEPAPER"}),(0,a.jsx)(h(),{href:"/help",target:"_blank",rel:"noopener noreferrer",className:"hover:text-primary transition",children:"HELP"})]})]})]}),(0,a.jsx)(v.a,{isOpen:l,onClose:()=>i(!1),title:"",children:(0,a.jsx)(L,{openWalletModal:()=>x(!0)})}),(0,a.jsx)(v.a,{isOpen:d,onClose:()=>o(!1),title:"",children:(0,a.jsx)(J.L,{openWalletModal:()=>x(!0)})}),(0,a.jsx)(q.o,{isOpen:c,onClose:()=>x(!1)})]})},Z=e=>{let{children:t,...n}=e;return(0,a.jsx)(r.N,{...n,children:t})};var Q=n(52618);let X=new i.E({defaultOptions:{queries:{refetchOnWindowFocus:!1}}});function $(e){let{children:t}=e,[n,i]=(0,s.useState)(!1),{resolvedTheme:y}=(0,r.D)();return(0,s.useEffect)(()=>{i(!0)},[]),(0,a.jsx)(Z,{attribute:"data-theme",defaultTheme:"dark",enableSystem:!0,children:(0,a.jsx)(l.x,{config:c.G,children:(0,a.jsx)(d.Ht,{client:X,children:(0,a.jsx)(W.O,{children:(0,a.jsxs)(o.qL,{avatar:m.PP,theme:n&&"dark"===y?(0,u.a)():(0,p._)(),children:[(0,a.jsx)(K,{}),t,(0,a.jsx)(Q.WalletAutoAdd,{})]})})})})})}},14416:(e,t,n)=>{Promise.resolve().then(n.bind(n,10355)),Promise.resolve().then(n.bind(n,52618)),Promise.resolve().then(n.t.bind(n,85035,23)),Promise.resolve().then(n.t.bind(n,68563,23))},23091:e=>{"use strict";e.exports=JSON.parse('{"WGBD":"0x65B5373C94CE38488B0a0B5aa0D6eFe55250e4ca","UniswapV2Factory":"0x76A8728d083181b585BE695DF33be9775506d622","UniswapV2Router02":"0xE934692c587094EFF21805A21d6ECc0F7ad4F7ff","StableSwapGateway":"0x5adF664785904B99e28966e88c0Ba5b2C9f5Cf97","AssetPurchase":"0x8Ab0D4FF9F1f2D78c27fEF91759FFFf35Ddd045a","SmartVault":"0x310a6D75edC6383fdfa8BA87873256A9ED95CA8f","TransferTracker":"0xc95457467F86C37ba44F93b90E962510d9188F4a","UserQueryHub":"0x34E21E24AEAD10EE5270a15e67342fc69673F623","WGBDLib":"0x5891D09788d825B4d8EF461A66644C8EC267e219"}')},52618:(e,t,n)=>{"use strict";n.d(t,{WalletAutoAdd:()=>d});var a=n(12115),s=n(2145),r=n(18224),l=n(29889),i=n(11580);let d=()=>{let{isConnected:e}=(0,s.F)(),t=(0,r.i)();return(0,l.U)().find(e=>"metaMask"===e.id),(0,a.useEffect)(()=>{var n,a;let s=async()=>{let e="0x"+i.J.id.toString(16);try{await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:e}]})}catch(a){if(4902===a.code){var t,n;await window.ethereum.request({method:"wallet_addEthereumChain",params:[{chainId:e,chainName:i.J.name,rpcUrls:i.J.rpcUrls.default.http,nativeCurrency:i.J.nativeCurrency,blockExplorerUrls:[(null==(n=i.J.blockExplorers)||null==(t=n.default)?void 0:t.url)||""]}]})}else console.error("Switch error:",a)}},r=null==(a=window)||null==(n=a.ethereum)?void 0:n.isMetaMask;e&&r&&t!==i.J.id&&s()},[e,t]),null}},68563:()=>{},75218:(e,t,n)=>{"use strict";n.d(t,{a:()=>s});var a=n(95155);n(12115);let s=e=>{let{title:t,children:n,onClose:s,isOpen:r}=e;return r?(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-base-100 rounded-xl shadow-lg w-full max-w-md p-6 relative",style:{maxWidth:"550px"},children:[(0,a.jsx)("button",{onClick:s,className:"absolute top-2 right-3 mt-3 btn btn-sm btn-ghost border-none outline-none text-lg text-info hover:bg-base-300","aria-label":"Close Modal",children:"\xd7"}),t&&(0,a.jsx)("h3",{className:"text-lg font-light mx-6 mb-4 text-primary",children:t}),n]})}):null}}},e=>{var t=t=>e(e.s=t);e.O(0,[4106,306,9268,8451,9096,6874,1613,284,3546,4975,8441,1684,7358],()=>t(14416)),_N_E=e.O()}]);