"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3452],{23091:e=>{e.exports=JSON.parse('{"WGBD":"0x65B5373C94CE38488B0a0B5aa0D6eFe55250e4ca","UniswapV2Factory":"0x76A8728d083181b585BE695DF33be9775506d622","UniswapV2Router02":"0xE934692c587094EFF21805A21d6ECc0F7ad4F7ff","StableSwapGateway":"0x5adF664785904B99e28966e88c0Ba5b2C9f5Cf97","AssetPurchase":"0x8Ab0D4FF9F1f2D78c27fEF91759FFFf35Ddd045a","SmartVault":"0x310a6D75edC6383fdfa8BA87873256A9ED95CA8f","TransferTracker":"0xc95457467F86C37ba44F93b90E962510d9188F4a","UserQueryHub":"0x34E21E24AEAD10EE5270a15e67342fc69673F623","WGBDLib":"0x5891D09788d825B4d8EF461A66644C8EC267e219"}')},34229:(e,t,n)=>{n.d(t,{AQ:()=>l,Mp:()=>d,PA:()=>r,Zu:()=>a,a7:()=>u,j9:()=>o,uI:()=>i,uK:()=>s,vI:()=>c});let a=[{assetId:120720,asset:{basePriceInUSD:BigInt(14e9),baseDays:90,perUnitDelay:5,variant:"eseries"},metadata:{name:"LGE20KW",model:"Legion E Series",description:"20KW Output ||| The revolutionary multifunctional generator designed to meet diverse energy needs with versatility and efficiency. This generator can seamlessly transition between portable configurations for demanding outdoor applications, retrofitted for mobile use in various applications, adaptable for grid-tied uses, making it an excellent choice for both residential and commercial power solutions. Additionally, users can opt for subscription based remote monitoring along with custom voltages and frequencies. Powerful performance with a space-saving design, ready to tackle any energy challenge you face. Whether used for backup power in emergencies or for everyday use, this multifunctional generator is the optimal solution.|||Product Dimensions: 18”x13”x9.5” (LxWxH)|||2 Year Limited Warranty|||Lead Times Vary Based on Enhancements|||*Images depicted are for visual illustration only.",image:"QmYourImageCIDHere",altImage:"QmAltExampleCID"}}],i=[{assetId:120745,asset:{basePriceInUSD:BigInt(15e9),baseDays:90,perUnitDelay:5,variant:"eseries"},metadata:{name:"LGE45KW",model:"Legion E Series",description:"45KW Output ||| The revolutionary multifunctional generator designed to meet diverse energy needs with versatility and efficiency. This generator can seamlessly transition between portable configurations for demanding outdoor applications, retrofitted for mobile use in various applications, adaptable for grid-tied uses, making it an excellent choice for both residential and commercial power solutions. Additionally, users can opt for subscription based remote monitoring along with custom voltages and frequencies. Powerful performance with a space-saving design, ready to tackle any energy challenge you face. Whether used for backup power in emergencies or for everyday use, this multifunctional generator is the optimal solution.|||Product Dimensions: 18”x13”x9.5” (LxWxH)|||2 Year Limited Warranty|||Lead Times Vary Based on Enhancements|||*Images depicted are for visual illustration only.",image:"QmYourImageCIDHere",altImage:"QmAltExampleCID"}}],s=[{assetId:120770,asset:{basePriceInUSD:BigInt(16e9),baseDays:90,perUnitDelay:5,variant:"eseries"},metadata:{name:"LGE70KW",model:"Legion E Series",description:"70KW Output ||| The revolutionary multifunctional generator designed to meet diverse energy needs with versatility and efficiency. This generator can seamlessly transition between portable configurations for demanding outdoor applications, retrofitted for mobile use in various applications, adaptable for grid-tied uses, making it an excellent choice for both residential and commercial power solutions. Additionally, users can opt for subscription based remote monitoring along with custom voltages and frequencies. Powerful performance with a space-saving design, ready to tackle any energy challenge you face. Whether used for backup power in emergencies or for everyday use, this multifunctional generator is the optimal solution.|||Product Dimensions: 18”x13”x9.5” (LxWxH)|||2 Year Limited Warranty|||Lead Times Vary Based on Enhancements|||*Images depicted are for visual illustration only.",image:"QmYourImageCIDHere",altImage:"QmAltExampleCID"}}],r=[{assetId:1207100,asset:{basePriceInUSD:BigInt(43e9),baseDays:180,perUnitDelay:5,variant:"xseries"},metadata:{name:"LGX100KW",model:"Legion X Series",description:"100KW Output ||| The revolutionary multifunctional generator designed to meet diverse energy needs with versatility and efficiency. This generator can seamlessly transition between portable configurations for demanding outdoor applications, retrofitted for mobile use in various applications, adaptable for grid-tied uses, making it an excellent choice for both residential and commercial power solutions. Additionally, users can opt for subscription based remote monitoring along with custom voltages and frequencies. Powerful performance with a space-saving design, ready to tackle any energy challenge you face. Whether used for backup power in emergencies or for everyday use, this multifunctional generator is the optimal solution.|||Product Dimensions: 45”x27”x16.5” (LxWxH)|||2 Year Limited Warranty|||Lead Times Vary Based on Enhancements|||*Images depicted are for visual illustration only.",image:"QmYourImageCIDHere",altImage:"QmAltExampleCID"}}],l=[{assetId:1207200,asset:{basePriceInUSD:BigInt(53e9),baseDays:180,perUnitDelay:5,variant:"xseries"},metadata:{name:"LGX200KW",model:"Legion X Series",description:"200KW Output ||| The revolutionary multifunctional generator designed to meet diverse energy needs with versatility and efficiency. This generator can seamlessly transition between portable configurations for demanding outdoor applications, retrofitted for mobile use in various applications, adaptable for grid-tied uses, making it an excellent choice for both residential and commercial power solutions. Additionally, users can opt for subscription based remote monitoring along with custom voltages and frequencies. Powerful performance with a space-saving design, ready to tackle any energy challenge you face. Whether used for backup power in emergencies or for everyday use, this multifunctional generator is the optimal solution.|||Product Dimensions: 45”x27”x16.5” (LxWxH)|||2 Year Limited Warranty|||Lead Times Vary Based on Enhancements|||*Images depicted are for visual illustration only.",image:"QmYourImageCIDHere",altImage:"QmAltExampleCID"}}],o=[{assetId:1207300,asset:{basePriceInUSD:BigInt(63e9),baseDays:180,perUnitDelay:5,variant:"xseries"},metadata:{name:"LGX300KW",model:"Legion X Series",description:"300KW Output ||| The revolutionary multifunctional generator designed to meet diverse energy needs with versatility and efficiency. This generator can seamlessly transition between portable configurations for demanding outdoor applications, retrofitted for mobile use in various applications, adaptable for grid-tied uses, making it an excellent choice for both residential and commercial power solutions. Additionally, users can opt for subscription based remote monitoring along with custom voltages and frequencies. Powerful performance with a space-saving design, ready to tackle any energy challenge you face. Whether used for backup power in emergencies or for everyday use, this multifunctional generator is the optimal solution.|||Product Dimensions: 45”x27”x16.5” (LxWxH)|||2 Year Limited Warranty|||Lead Times Vary Based on Enhancements|||*Images depicted are for visual illustration only.",image:"QmYourImageCIDHere",altImage:"QmAltExampleCID"}}],d=[{assetId:1207400,asset:{basePriceInUSD:BigInt(73e9),baseDays:180,perUnitDelay:5,variant:"xseries"},metadata:{name:"LGX400KW",model:"Legion X Series",description:"400KW Output ||| The revolutionary multifunctional generator designed to meet diverse energy needs with versatility and efficiency. This generator can seamlessly transition between portable configurations for demanding outdoor applications, retrofitted for mobile use in various applications, adaptable for grid-tied uses, making it an excellent choice for both residential and commercial power solutions. Additionally, users can opt for subscription based remote monitoring along with custom voltages and frequencies. Powerful performance with a space-saving design, ready to tackle any energy challenge you face. Whether used for backup power in emergencies or for everyday use, this multifunctional generator is the optimal solution.|||Product Dimensions: 45”x27”x16.5” (LxWxH)|||2 Year Limited Warranty|||Lead Times Vary Based on Enhancements|||*Images depicted are for visual illustration only.",image:"QmYourImageCIDHere",altImage:"QmAltExampleCID"}}],c=[{assetId:1207500,asset:{basePriceInUSD:BigInt(8e12),baseDays:180,perUnitDelay:5,variant:"xseries"},metadata:{name:"LGX500KW",model:"Legion X Series",description:"500KW Output ||| The revolutionary multifunctional generator designed to meet diverse energy needs with versatility and efficiency. This generator can seamlessly transition between portable configurations for demanding outdoor applications, retrofitted for mobile use in various applications, adaptable for grid-tied uses, making it an excellent choice for both residential and commercial power solutions. Additionally, users can opt for subscription based remote monitoring along with custom voltages and frequencies. Powerful performance with a space-saving design, ready to tackle any energy challenge you face. Whether used for backup power in emergencies or for everyday use, this multifunctional generator is the optimal solution.|||Product Dimensions: 45”x27”x16.5” (LxWxH)|||2 Year Limited Warranty|||Lead Times Vary Based on Enhancements|||*Images depicted are for visual illustration only.",image:"QmYourImageCIDHere",altImage:"QmAltExampleCID"}}],u=[{assetId:1207600,asset:{basePriceInUSD:BigInt(9e11),baseDays:180,perUnitDelay:5,variant:"xseries"},metadata:{name:"LGX600KW",model:"Legion X Series",description:"600KW Output ||| The revolutionary multifunctional generator designed to meet diverse energy needs with versatility and efficiency. This generator can seamlessly transition between portable configurations for demanding outdoor applications, retrofitted for mobile use in various applications, adaptable for grid-tied uses, making it an excellent choice for both residential and commercial power solutions. Additionally, users can opt for subscription based remote monitoring along with custom voltages and frequencies. Powerful performance with a space-saving design, ready to tackle any energy challenge you face. Whether used for backup power in emergencies or for everyday use, this multifunctional generator is the optimal solution.|||Product Dimensions: 45”x27”x16.5” (LxWxH)|||2 Year Limited Warranty|||Lead Times Vary Based on Enhancements|||*Images depicted are for visual illustration only.",image:"QmYourImageCIDHere",altImage:"QmAltExampleCID"}}]},62290:(e,t,n)=>{n.d(t,{h:()=>G});var a=n(95155),i=n(12115),s=n(75218),r=n(2145),l=n(68183),o=n(38227),d=n(32064);let c=(0,n(65453).v)(e=>({asset:null,quantity:1,tokenSymbol:"GBDO",estimatedTotal:"0.00",estimatedEscrow:"0.00",buyer:"",paymentMethod:"native",voltage:null,frequency:null,phase:null,stripeSessionId:null,stripeConfirmation:null,userAddress:"",txhash:null,transactionStatus:null,setField:(t,n)=>e({[t]:n}),reset:()=>e({asset:null,quantity:1,tokenSymbol:"GBDO",estimatedTotal:"0.00",estimatedEscrow:"0.00",buyer:"",paymentMethod:"native",voltage:null,frequency:null,phase:null,stripeSessionId:null,stripeConfirmation:null,userAddress:null,txhash:null,transactionStatus:null})}));var u=n(62774),p=n(33771);let m={USD:1,AED:.27,AUD:.66,BRL:.19,CAD:.73,CHF:1.12,CNY:.14,DAI:1.01,EUR:1.08,FDUSD:1,FRAX:1,GBP:1.27,GUSD:1,INR:.012,JPY:.0064,KRW:75e-5,MXN:.055,PYUSD:1,SGD:.74,TUSD:1,USDP:1,USDT:1,ZAR:.054,ZARP:.3072,BRL1:.19,NGNT:65e-5,GBPT:1.27,ARSX:75e-5,INRX:.012,TRYX:.031},y=e=>{let{checkoutAsset:t,quantity:n,paymentMethod:a,selectedCurrency:i,estimatedTotal:s,stripeConfirmation:r,txhash:l,userAddress:o,deliveryDays:d,deliveryDeadline:c}=e;return{asset:{id:null==t?void 0:t.id,name:null==t?void 0:t.name},quantity:n,payment:{method:a,currency:i,amount:s,referenceId:(null==r?void 0:r.id)||l||null},buyer:o||"anonymous",delivery:{days:d,deadline:c},timestamp:new Date().toISOString()}};var x=n(11580),h=n(6855),f=n(15709),b=n(17892),g=n(2804),v=n(48062),j=n(87358),T=n(44134).Buffer;let w=new h.Y({endpoint:"https://s3.filebase.com",region:"us-east-1",credentials:{accessKeyId:j.env.FILEBASE_KEY,secretAccessKey:j.env.FILEBASE_SECRET}});async function N(e,t){let n=T.from(JSON.stringify(t));await w.send(new f.w({Bucket:"your-bucket-name",Key:"".concat(e,".json"),Body:n,ContentType:"application/json"}));let a=await g.s.digest(n);return{cid:b.TO.create(1,v.aY,a).toString()}}var D=n(23091),I=n(20482),S=n(13568),C=n(21571),k=n(73703),U=n(23726),P=n(10136),E=n(77837),M=n(8777);let A=JSON.parse('{"H":[{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"previousAdmin","type":"address"},{"indexed":false,"internalType":"address","name":"newAdmin","type":"address"}],"name":"AdminChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"string","name":"name","type":"string"}],"name":"AssetAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"beacon","type":"address"}],"name":"BeaconUpgraded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"string","name":"cid","type":"string"}],"name":"CompletionUploaded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"}],"name":"EscrowReleased","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"newDeadline","type":"uint256"}],"name":"ExtensionApproved","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"extraDays","type":"uint256"}],"name":"ExtensionProposed","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint8","name":"version","type":"uint8"}],"name":"Initialized","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"string","name":"cid","type":"string"}],"name":"ProgressUploaded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":true,"internalType":"address","name":"buyer","type":"address"},{"indexed":false,"internalType":"uint64","name":"assetId","type":"uint64"}],"name":"Purchased","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"}],"name":"Refunded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"implementation","type":"address"}],"name":"Upgraded","type":"event"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"name":"approveExtension","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"uint256","name":"graceDays","type":"uint256"}],"name":"cancelPurchase","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"feeBasisPoints","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"name":"getPurchase","outputs":[{"components":[{"internalType":"address","name":"buyer","type":"address"},{"internalType":"address","name":"tokenUsed","type":"address"},{"internalType":"uint64","name":"assetId","type":"uint64"},{"internalType":"uint32","name":"quantity","type":"uint32"},{"internalType":"uint128","name":"depositAmount","type":"uint128"},{"internalType":"uint128","name":"escrowAmount","type":"uint128"},{"internalType":"uint64","name":"purchaseTime","type":"uint64"},{"internalType":"uint64","name":"deliveryDeadline","type":"uint64"},{"internalType":"string","name":"progressCID","type":"string"},{"internalType":"string","name":"completionCID","type":"string"},{"internalType":"uint8","name":"status","type":"uint8"},{"internalType":"uint64","name":"proposedExtension","type":"uint64"},{"internalType":"bool","name":"extensionPending","type":"bool"}],"internalType":"struct AssetPurchaseLib.Purchase","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserPurchases","outputs":[{"components":[{"internalType":"address","name":"buyer","type":"address"},{"internalType":"address","name":"tokenUsed","type":"address"},{"internalType":"uint64","name":"assetId","type":"uint64"},{"internalType":"uint32","name":"quantity","type":"uint32"},{"internalType":"uint128","name":"depositAmount","type":"uint128"},{"internalType":"uint128","name":"escrowAmount","type":"uint128"},{"internalType":"uint64","name":"purchaseTime","type":"uint64"},{"internalType":"uint64","name":"deliveryDeadline","type":"uint64"},{"internalType":"string","name":"progressCID","type":"string"},{"internalType":"string","name":"completionCID","type":"string"},{"internalType":"uint8","name":"status","type":"uint8"},{"internalType":"uint64","name":"proposedExtension","type":"uint64"},{"internalType":"bool","name":"extensionPending","type":"bool"}],"internalType":"struct AssetPurchaseLib.Purchase[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_owner","type":"address"},{"internalType":"uint256","name":"_initialFeeBps","type":"uint256"}],"name":"initialize","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"uint256","name":"extraDays","type":"uint256"}],"name":"proposeExtension","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"proxiableUUID","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint64","name":"assetId","type":"uint64"},{"internalType":"uint32","name":"quantity","type":"uint32"},{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"rate","type":"uint256"},{"internalType":"address","name":"feeRecipient","type":"address"}],"name":"purchase","outputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"name":"refund","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"}],"name":"releaseEscrow","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"uint128","name":"priceInUSD","type":"uint128"},{"internalType":"string","name":"cid","type":"string"},{"internalType":"uint32","name":"baseDays","type":"uint32"},{"internalType":"uint32","name":"delayPerUnit","type":"uint32"}],"name":"setAsset","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"newBps","type":"uint256"}],"name":"setFeeBasisPoints","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newImplementation","type":"address"}],"name":"upgradeTo","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newImplementation","type":"address"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"upgradeToAndCall","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"string","name":"cid","type":"string"}],"name":"uploadCompletion","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"id","type":"uint256"},{"internalType":"string","name":"cid","type":"string"}],"name":"uploadProgress","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint128","name":"amount","type":"uint128"},{"internalType":"uint256","name":"lockedEscrow","type":"uint256"},{"internalType":"uint256","name":"withinGracePeriod","type":"uint256"}],"name":"withdrawTokens","outputs":[],"stateMutability":"nonpayable","type":"function"}]}'),O=async e=>{var t,n,a,i,s,r;let{currentStep:l,paymentMethod:o,transactionStatus:d="",txhash:c,userAddress:u,chainId:p,checkoutAsset:m,estimatedTotal:y,tokenSymbol:x,quantity:h,toast:f,openWalletModal:b,publicClient:g,setField:v,smartAccountClient:j,logToPrisma:T,initiateStripeCheckout:w,setFinalizing:N,getContractAddress:D}=e,I=m.name,S=parseFloat(y),C=new Date().toISOString(),O=async(e,t)=>{u&&(await T({contractaddress:"",calldata:"",signature:"",gaslimit:BigInt(0),nonce:BigInt(0),userOpHash:"",txhash:"",userAddress:u,asset:I,amount:S,quantity:h,status:e,chainstatus:!1,queuedat:C,processedat:null,priority:1,retrycount:0,receiptHash:"",blockNumber:null,gasUsed:null,notes:t}),v("transactionStatus",e),N(!1))};if(8!==l||"accepted"===d||c)return void N(!1);if("cash"===o){try{await w(I,h,S)}catch(e){f.error("Stripe initiation failed."),await O("failed",null!=(t=e.message)?t:"Stripe error")}finally{N(!1)}return}if(!j||"number"!=typeof p){f.error("Smart wallet not ready."),null==b||b(),await O("failed","Smart wallet not initialized or chain ID missing");return}try{let e=await j.getAddress(),t=await g.getBalance({address:e}),r=BigInt(Math.floor(1e18*S));if(t<r){f.error("Insufficient smart wallet balance."),await O("failed","Insufficient balance");return}let l=D("AssetPurchase"),o=new k.KA(A.H).encodeFunctionData("buyAsset",[m.id,h]),d=(0,U.g5)(y),c=!0;try{await g.getBlockNumber()}catch(e){c=!1}let u=await j.buildUserOp([{to:l,data:o,value:d}]),p=await j.estimateUserOpGas(u),x=(0,P.Dg)(null!=(a=null!=(n=p.callGasLimit)?n:p.preVerificationGas)?a:0),b=await j.getNonce(),w=await j.buildUserOp([{to:l,data:o,value:d}]),N=await j.signUserOp(w),L=(0,E.c$)(N.signature),R=await j.getUserOpHash(N);if(await T({contractaddress:l,calldata:o,signature:L,gaslimit:x,nonce:b,userOpHash:R,txhash:"",userAddress:e,asset:I,amount:S,quantity:h,status:"queued",chainstatus:!1,queuedat:C,processedat:null,priority:1,retrycount:0,receiptHash:"",blockNumber:null,gasUsed:null,notes:c?"Pending submission":"RPC unavailable, intent captured"}),!c)return void f.error("Chain unavailable. Transaction will be retried.");let B=await j.sendSignedUserOp(N),F=null!=(i=(await B.waitForTxHash()).transactionHash)?i:null,W=await g.getTransactionReceipt({hash:F}),H=(null==W?void 0:W.blockNumber)?(0,P.Dg)(W.blockNumber):null,Y=(null==W?void 0:W.gasUsed)?(0,P.Dg)(W.gasUsed):null,G=(0,M.createHash)("sha256").update(JSON.stringify(W)).digest("hex");(null!=(s=w.callData)?s:o)!==o&&console.warn("Calldata mismatch detected."),await T({contractaddress:l,calldata:o,signature:L,gaslimit:x,nonce:b,userOpHash:R,txhash:null!=F?F:void 0,userAddress:e,asset:I,amount:S,quantity:h,status:"accepted",chainstatus:!0,queuedat:C,processedat:new Date().toISOString(),priority:1,retrycount:0,blockNumber:H,gasUsed:Y,receiptHash:G,notes:H?"Finalized | Block ".concat(H):"Finalized"}),v("txhash",null!=F?F:null),v("userOpHash",R),v("transactionStatus","accepted"),alert("Transaction accepted.")}catch(e){console.warn("Smart wallet transaction failed:",e.message),await O("queued",null!=(r=e.message)?r:"Fallback error")}finally{N(!1)}},L=async e=>{let{currentStep:t,paymentMethod:n,checkoutAsset:a,estimatedTotal:i,tokenSymbol:s,quantity:r,toast:l,publicClient:o,smartAccountClient:d,userAddress:c,chainId:u}=e;await O({currentStep:null!=t?t:8,paymentMethod:null!=n?n:"cash",checkoutAsset:a,estimatedTotal:i,tokenSymbol:s,quantity:r,toast:l,publicClient:o,smartAccountClient:d,userAddress:c,chainId:u,txhash:void 0,transactionStatus:void 0,openWalletModal:()=>console.log("Open wallet modal"),setField:(e,t)=>console.log("Set ".concat(e," to ").concat(t)),setFinalizing:e=>console.log("Finalizing: ".concat(e)),initiateStripeCheckout:async()=>console.log("Stripe checkout initiated"),getContractAddress:e=>D[e],logToPrisma:async e=>(console.log("Logging to Prisma:",e),Promise.resolve())})},R=(0,o.l)({chain:x.J,transport:(0,d.L)()}),B=e=>{var t,n,o;let{onClose:d,openWalletModal:x,asset:h,selectedCurrency:f,variationGroups:b,selectedVariations:g,setSelectedVariations:v}=e,[j,T]=(0,i.useState)(1);(0,i.useEffect)(()=>{fetch("/legal/terms-conditions.txt").then(e=>e.text()).then(_),fetch("/legal/privacy-policy.txt").then(e=>e.text()).then($),fetch("/legal/refund-returns.txt").then(e=>e.text()).then(ee)},[]);let[w,D]=(0,i.useState)(!1),[k,U]=(0,i.useState)(!1),[P,E]=(0,i.useState)(!1),[M,A]=(0,i.useState)(!1);new u.k(window.ethereum);let{chain:O}=(0,r.F)();null==O||O.id;let[B,F]=(0,i.useState)(360),[W,H]=(0,i.useState)(""),[Y,G]=(0,i.useState)(""),Q=g.epanel,V=g.xpanel,q=(null==Q?void 0:Q.label)==="Restricted"&&120===B,K=(null==V?void 0:V.label)==="Restricted"&&360===B&&"3-PHASE"===W&&"60Hz"===Y,z=q||K,[X,_]=(0,i.useState)(""),[J,$]=(0,i.useState)(""),[Z,ee]=(0,i.useState)(""),{address:et}=(0,r.F)(),{writeContractAsync:en}=(0,l.x)(),{asset:ea,quantity:ei,tokenSymbol:es,estimatedTotal:er,estimatedEscrow:el,paymentMethod:eo,stripeSessionId:ed,stripeConfirmation:ec,txhash:eu,userAddress:ep,transactionStatus:em,ipfsCid:ey,setField:ex}=c();(0,i.useEffect)(()=>{h&&ex("asset",{id:h.assetId,name:h.name,metadataCID:"",priceInUSD:0,baseDays:0,perUnitDelay:0,variant:"eseries"})},[h]),(0,i.useEffect)(()=>{(async()=>{if(ed&&!ec)try{let e=await fetch("/api/get-session?session_id=".concat(ed)),t=await e.json();ex("stripeConfirmation",t.session)}catch(e){console.error("Stripe session fetch failed:",e)}})()},[ed]);let eh={epanel:"Panel Configuration",xpanel:"Panel Configuration",monitoring:"Remote Monitoring",etie:"Grid Integration",xtie:"Grid Integration"},ef=(null!=(n=null==ea?void 0:ea.baseDays)?n:0)+(null!=(o=null==ea?void 0:ea.perUnitDelay)?o:0)*(ei-1),eb=new Date(Date.now()+864e5*ef).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),[eg,ev]=(0,i.useState)(null);(0,i.useMemo)(()=>Object.values(g).reduce((e,t)=>e+Number(t.apriceInUSD),0)/100,[g]);let[ej,eT]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{8===j&&("cash"!==eo||ec)&&!ej&&(async()=>{eT(!0);try{let e=y({checkoutAsset:ea,quantity:ei,paymentMethod:eo,selectedCurrency:es,estimatedTotal:er,stripeConfirmation:ec,txhash:eu,userAddress:ep,deliveryDays:5,deliveryDeadline:new Date(Date.now()+432e6).toISOString()}),{cid:t}=await N("receipt-".concat(eu),e);t?ex("ipfsCid",t):console.warn("Upload succeeded but CID was missing.")}catch(e){console.error("Receipt finalization failed:",e)}finally{eT(!1)}})()},[j,ej,eo,ec,eu,ea,ei,es,er,ep]),(0,a.jsxs)(s.a,{isOpen:!0,onClose:()=>{ev(null),T(1),d()},title:"",children:[(0,a.jsx)("div",{className:"flex justify-between text-xs mt-15 mb-6 px-2",children:["Configure","Tuning","Terms","Refunds","Privacy","Method","Review","Done"].map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full border-1 mb-6 ".concat(j>t?"bg-info border-info":j===t?"bg-secondary border-info":"border-gray-400")}),(0,a.jsx)("span",{className:"".concat(j===t?"font-light text-info":"text-gray-500"),children:e})]},e))}),(0,a.jsxs)("div",{className:"space-y-2 h-[600px] flex flex-col",children:[1===j&&(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 space-y-6",children:[(0,a.jsx)("h3",{className:"text-xl font-light tracking-tight mb-10 text-info",children:"SYSTEM CONFIGURATION"}),b.epanel?(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-xs font-light text-info-400 mb-2 uppercase tracking-wide",children:eh.epanel||"epanel"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-4",children:b.epanel.map(e=>{var t;let n=(null==(t=g.epanel)?void 0:t.label)===e.label;return(0,a.jsxs)("button",{onClick:()=>{v(t=>({...t,epanel:e})),ev("Customize"===e.label?"epanel":null)},className:"w-full h-[60px] p-3 border rounded-full shadow-sm flex flex-col justify-between ".concat(n?"bg-black/50 border-info text-info":"bg-secondary border-gray-600 hover:bg-neutral-800"),children:[(0,a.jsx)("div",{className:"font-light",children:e.label}),(0,a.jsxs)("div",{className:"text-xs text-info-300",children:["+$",Number(e.apriceInUSD)/1e6," USD"]})]},"epanel-".concat(e.label))})})]}):b.xpanel&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-light text-info-400 mb-2 uppercase tracking-wide",children:eh.xpanel||"xpanel"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-4",children:b.xpanel.map(e=>{var t;let n=(null==(t=g.xpanel)?void 0:t.label)===e.label;return(0,a.jsxs)("button",{onClick:()=>{v(t=>({...t,xpanel:e})),ev("Customize"===e.label?"xpanel":null)},className:"w-full h-[60px] p-3 border rounded-full shadow-sm flex flex-col justify-between ".concat(n?"bg-black/50 border-info text-info":"bg-secondary border-gray-600 hover:bg-neutral-800"),children:[(0,a.jsx)("div",{className:"font-light",children:e.label}),(0,a.jsxs)("div",{className:"text-xs text-info-300",children:["+$",Number(e.apriceInUSD)/1e6," USD"]})]},"xpanel-".concat(e.label))})})]}),b.etie?(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-xs font-light text-info-400 mb-2 mt-8 uppercase tracking-wide",children:eh.etie||"etie"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-4",children:b.etie.map(e=>{var t;let n=(null==(t=g.etie)?void 0:t.label)===e.label;return(0,a.jsxs)("button",{onClick:()=>{v(t=>({...t,etie:e})),ev("Customize"===e.label?"etie":null)},className:"w-full h-[60px] p-3 border rounded-full shadow-sm flex flex-col justify-between ".concat(n?"bg-black/50 border-info text-info":"bg-secondary border-gray-600 hover:bg-neutral-800"),children:[(0,a.jsx)("div",{className:"font-light",children:e.label}),(0,a.jsxs)("div",{className:"text-xs text-info-300",children:["+$",Number(e.apriceInUSD)/1e6," USD"]})]},"etie-".concat(e.label))})})]}):b.xtie&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-light text-info-400 mb-2 mt-8 uppercase tracking-wide",children:eh.xtie||"xtie"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-4",children:b.xtie.map(e=>{var t;let n=(null==(t=g.xtie)?void 0:t.label)===e.label;return(0,a.jsxs)("button",{onClick:()=>{v(t=>({...t,xtie:e})),ev("Customize"===e.label?"xtie":null)},className:"w-full h-[60px] p-3 border rounded-full shadow-sm flex flex-col justify-between ".concat(n?"bg-black/50 border-info text-info":"bg-secondary border-gray-600 hover:bg-neutral-800"),children:[(0,a.jsx)("div",{className:"font-light",children:e.label}),(0,a.jsxs)("div",{className:"text-xs text-info-300",children:["+$",Number(e.apriceInUSD)/1e6," USD"]})]},"xtie-".concat(e.label))})})]}),b.monitoring&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-xs font-light text-info-400 mb-2 mt-8 uppercase tracking-wide",children:eh.monitoring||"monitoring"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-4",children:b.monitoring.map(e=>{var t;let n=(null==(t=g.monitoring)?void 0:t.label)===e.label;return(0,a.jsxs)("button",{onClick:()=>{v(t=>({...t,monitoring:e})),ev("Customize"===e.label?"monitoring":null)},className:"w-full h-[60px] p-3 border rounded-full shadow-sm flex flex-col justify-between ".concat(n?"bg-black/50 border-info text-info":"bg-secondary border-gray-600 hover:bg-neutral-800"),children:[(0,a.jsx)("div",{className:"font-light",children:e.label}),(0,a.jsxs)("div",{className:"text-xs text-info-300",children:["+$",Number(e.apriceInUSD)/1e6," USD"]})]},"monitoring-".concat(e.label))})})]})]}),(0,a.jsx)("div",{className:"flex justify-end gap-2 p-4 border-t bg-transparent",children:(0,a.jsx)("button",{className:"btn btn-primary text-base-200 btn-sm",onClick:()=>{var e;T(eg&&(null==(e=g[eg])?void 0:e.label)==="Customize"?2:3)},children:"Next"})})]}),2===j&&(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 space-y-6",children:[(0,a.jsx)("h3",{className:"text-xl font-light tracking-tight mb-4 text-info",children:"CUSTOMIZE OUTPUT"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-light text-info-400 mt-10 mb-6",children:"VOLTAGE OUTPUT"}),(0,a.jsx)("input",{type:"range",min:120,max:800,step:10,value:B,onChange:e=>{let t=Number(e.target.value);F(t),ex("voltage",t)},className:"range range-secondary w-full"}),(0,a.jsxs)("p",{className:"text-sm text-center text-light text-info-300",children:["Voltage: ",(0,a.jsxs)("strong",{children:[B,"V"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-light text-info-400 mt-10 mb-6",children:"FREQUENCY OUTPUT"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:["50Hz","60Hz"].map(e=>(0,a.jsx)("button",{onClick:()=>{G(e),ex("frequency",e)},className:"w-full py-2 border rounded-full text-sm btn-black ".concat(Y===e?"bg-secondary text-info border-info":"bg-black/50 border-info text-info-400 hover:bg-neutral-800"),children:e},e))}),(0,a.jsxs)("p",{className:"text-sm mt-6 mb-6 text-light text-center text-info-300",children:["Frequency: ",(0,a.jsx)("strong",{children:Y||"—"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-light text-info-400 mt-10 mb-6",children:"PHASE OUTPUT"}),(0,a.jsx)("div",{className:"grid grid-cols-3 gap-3",children:["Single-Phase","Split-Phase","3-Phase"].map(e=>(0,a.jsx)("button",{onClick:()=>{H(e),ex("phase",e)},className:"w-full py-2 border rounded-full text-sm btn-black ".concat(W===e?"bg-secondary text-info border-info":"bg-black/50 border-info text-info-400 hover:bg-neutral-800"),children:e},e))}),(0,a.jsxs)("p",{className:"text-sm mt-6 mb-6 text-light text-center text-info-300",children:["Phase: ",(0,a.jsx)("strong",{children:W||"—"})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 p-4 border-t bg-transparent",children:[j>1&&(0,a.jsx)("button",{className:"btn btn-secondary btn-pri text-base-200 btn-sm",onClick:()=>T(e=>Math.max(e-1,1)),children:"Previous"}),(0,a.jsx)("button",{className:"btn btn-round btn-primary text-base-200 btn-sm ".concat(z?"opacity-50 cursor-not-allowed":""),disabled:z,onClick:()=>T(e=>Math.max(e+1,1)),children:"Next"})]})]}),3===j&&(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 space-y-6",children:[(0,a.jsx)("h3",{className:"text-lg font-light",children:"TERMS & CONDITIONS"}),(0,a.jsx)("div",{className:"max-h-[400px] overflow-y-auto text-sm border p-3 rounded bg-black text-justify text-info-300",children:X||"Loading…"}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("input",{type:"checkbox",checked:w,onChange:()=>D(!w)}),"I agree to the Terms & Conditions Policy"]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 p-4 border-t bg-transparent",children:[(0,a.jsx)("button",{className:"btn btn-secondary text-base-200 btn-sm",onClick:()=>{var e;eg&&(null==(e=g[eg])?void 0:e.label)==="Customize"?T(2):T(1)},children:"Previous"}),(0,a.jsx)("button",{className:"btn btn-primary text-base-200 btn-sm",onClick:()=>{w&&T(4)},disabled:!w,children:"Next"})]})]}),4===j&&(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 space-y-6",children:[(0,a.jsx)("h3",{className:"text-lg font-light",children:"REFUNDS & RETURNS"}),(0,a.jsx)("div",{className:"text-sm border p-3 rounded bg-black text-justify text-info-300 max-h-[400px] overflow-y-auto",children:Z||"Loading…"}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("input",{type:"checkbox",checked:k,onChange:()=>U(!k)}),"I agree to the Refunds & Returns Policy"]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 p-4 border-t bg-transparent",children:[(0,a.jsx)("button",{className:"btn btn-secondary text-base-200 btn-sm",onClick:()=>T(e=>Math.max(e-1,1)),children:"Previous"}),(0,a.jsx)("button",{className:"btn btn-primary text-base-200 btn-sm",onClick:()=>{k&&T(5)},disabled:!k,children:"Next"})]})]}),5===j&&(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 space-y-6",children:[(0,a.jsx)("h3",{className:"text-lg font-light",children:"PRIVACY POLICY"}),(0,a.jsx)("div",{className:"max-h-[400px] overflow-y-auto text-sm border p-3 rounded bg-black text-justify text-info-300",children:J||"Loading…"}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("input",{type:"checkbox",checked:P,onChange:()=>E(!P)}),"I agree to the Privacy Policy"]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 p-4 border-t bg-transparent",children:[(0,a.jsx)("button",{className:"btn btn-secondary text-base-200 btn-sm",onClick:()=>T(e=>Math.max(e-1,1)),children:"Previous"}),(0,a.jsx)("button",{className:"btn btn-primary text-base-200 btn-sm",onClick:()=>{P&&T(6)},disabled:!P,children:"Next"})]})]}),6===j&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{className:"text-lg font-light mb-10 text-info",children:"SELECT PAYMENT METHOD"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"border-b border-base-300 pb-4",children:(0,a.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"paymentMethod",checked:"native"===eo,onChange:()=>ex("paymentMethod","native"),className:"radio radio-info mt-1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-md font-medium",children:"Global Dollar (GBDO)"}),(0,a.jsx)("p",{className:"text-xs text-info-400 mt-1",children:"Requires wallet connection."})]})]})}),(0,a.jsx)("div",{className:"border-b border-base-300 pb-4",children:(0,a.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"paymentMethod",checked:"stable"===eo,onChange:()=>ex("paymentMethod","stable"),className:"radio radio-info mt-1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-md font-medium",children:"Stablecoin"}),(0,a.jsx)("p",{className:"text-xs text-info-400 mt-1",children:"Requires wallet connection. Includes stablecoin routing fee of 0.25%."}),(0,a.jsx)("select",{className:"select select-black w-full text-info-600 mb-4 focus:outline-none focus:ring-0 focus:border-transparent",value:es,onChange:e=>ex("tokenSymbol",e.target.value),children:Object.entries(p.L).filter(e=>{let[t,n]=e;return"GBDO"!==n.symbol}).map(e=>{let[t,n]=e;return(0,a.jsxs)("option",{value:n.symbol,children:[n.symbol," — ",n.name]},n.symbol)})})]})]})}),(0,a.jsx)("div",{className:"pb-2",children:(0,a.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,a.jsx)("input",{type:"radio",name:"paymentMethod",checked:"cash"===eo,onChange:()=>ex("paymentMethod","cash"),className:"radio radio-info mt-1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-md font-medium",children:"Cash via Stripe"}),(0,a.jsx)("p",{className:"text-xs text-warning-400 mt-1 mb-4",children:"No wallet required. Includes a processing fee of 2.9% + $0.30 USD."})]})]})})]}),(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsx)("div",{className:"flex-grow overflow-y-auto p-4"}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-t bg-transparent",children:["cash"!==eo?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(I.g_,{}),!ep&&(0,a.jsx)("span",{className:"text-red-500 text-sm",children:"Wallet required"})]}):(0,a.jsx)("div",{}),(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[j>1&&(0,a.jsx)("button",{className:"btn btn-secondary text-base-200 btn-sm",onClick:()=>T(e=>Math.max(e-1,1)),children:"Previous"}),(0,a.jsx)("button",{className:"btn btn-primary text-base-200 btn-sm",onClick:()=>T(7),disabled:"cash"!==eo&&!ep,children:"Next"})]})]})]})]}),7===j&&ea&&(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 space-y-6 text-sm",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"REVIEW & CHECKOUT"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"font-light text-info-400",children:"PAYMENT"}),(0,a.jsxs)("p",{children:["Method: ",(0,a.jsx)("strong",{children:"native"===eo?"GBDO":"stable"===eo?"".concat(es," (Stablecoin)"):"Cash via Stripe"})]}),(0,a.jsxs)("p",{children:["Estimated Total: ",(0,a.jsxs)("strong",{children:[er," ","cash"===eo?"USD":es]})]}),"stable"!==eo&&(0,a.jsxs)("p",{children:["Protocol Fee: ",(0,a.jsxs)("strong",{children:[(25*Number(er)/1e6).toFixed(6)," ",es]})]}),"cash"===eo&&(0,a.jsx)("p",{className:"text-warning",children:"Stripe Processing Fee applies (2.9% + $0.30 USD)"})]}),(0,a.jsx)("hr",{className:"border-gray-700"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"font-light text-info-400",children:"PRODUCT"}),(0,a.jsxs)("p",{children:["Name: ",(0,a.jsx)("strong",{children:ea.name})]}),(0,a.jsxs)("p",{children:["Asset ID: ",(0,a.jsx)("strong",{children:ea.id})]}),(0,a.jsxs)("p",{children:["Quantity: ",(0,a.jsx)("strong",{children:ei})]})]}),(0,a.jsx)("hr",{className:"border-gray-700"}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"font-light text-info-400",children:"DELIVERY"}),(0,a.jsxs)("p",{children:["Time: ",(0,a.jsxs)("strong",{children:[ef," days"]})]}),(0,a.jsxs)("p",{children:["Deadline: ",(0,a.jsx)("strong",{children:eb})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 p-4 border-t bg-transparent",children:[(0,a.jsx)("button",{className:"btn btn-secondary text-base-200 btn-sm",onClick:()=>T(e=>Math.max(e-1,1)),children:"Previous"}),(0,a.jsx)("button",{className:"btn btn-primary text-base-200 btn-sm",onClick:async()=>{if(!eo)return void alert("Please select a payment method.");if("stable"===eo&&!es)return void alert("Please select a stablecoin.");let e=function(e,t,n,a){var i;let s=Object.values(e).reduce((e,t)=>e+Number(t.apriceInUSD),0)/100,r=s;return"stable"===t&&(r+=.0025*s),"cash"===t&&(r+=.029*s+.3),Math.round(100*(r*("GBDO"===n?1:null!=(i=a[n])?i:1)))/100}(g,eo,es,m);ex("estimatedTotal",e.toFixed(2)),ex("userAddress",null!=et?et:""),ex("asset",ea);let{smartAccountClient:t}=(0,C.y)();await L({currentStep:8,paymentMethod:eo,checkoutAsset:ea,estimatedTotal:e.toFixed(2),tokenSymbol:es,quantity:ei,toast:S.oR,publicClient:R,smartAccountClient:t,userAddress:null!=ep?ep:"",chainId:0xc72dd9d5e79b7})},children:"Confirm Purchase"})]})]}),8===j&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Purchase Summary"}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto text-sm border p-4 rounded bg-black space-y-3",children:[(0,a.jsx)("p",{className:"font-medium ".concat("failed"===em?"text-red-500":"text-green-500"),children:"accepted"===em?"Transaction Accepted — Awaiting Confirmation":"confirmed"===em?"Transaction Confirmed":"failed"===em?"Transaction Failed":"Finalizing Payment..."}),"cash"===eo?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{children:["Stripe Checkout: ",(0,a.jsx)("strong",{children:"Paid via Stripe"})]}),ec?(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{children:["Amount Paid: ",(0,a.jsxs)("strong",{children:["$",(ec.amount_total/100).toFixed(2)]})]}),(0,a.jsxs)("p",{children:["Receipt Sent To: ",(0,a.jsx)("strong",{children:null==(t=ec.customer_details)?void 0:t.email})]}),(0,a.jsxs)("p",{children:["Stripe Reference ID:"," ",(0,a.jsx)("code",{className:"text-xs bg-gray-800 p-1 rounded",children:ec.id})]})]}):(0,a.jsx)("p",{className:"italic text-gray-400",children:"Waiting for Stripe confirmation…"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{children:["Crypto Checkout: ",(0,a.jsx)("strong",{children:es||"Native Token"})]}),eu?(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{children:["Blockchain Transaction:"," ",(0,a.jsx)("a",{href:"https://explorer.myblockchain.com/tx/".concat(eu),target:"_blank",rel:"noopener noreferrer",className:"underline text-blue-500",title:"View transaction on blockchain",children:"View on Explorer"})]}),(0,a.jsx)("p",{className:"italic text-gray-400",children:"Confirmation may take some time depending on network activity."})]}):(0,a.jsx)("p",{className:"italic text-gray-400",children:"Preparing transaction…"})]}),ej?(0,a.jsx)("p",{className:"italic text-gray-400",children:"Finalizing purchase… This may take a few seconds."}):ey?(0,a.jsxs)("p",{children:["IPFS Receipt:"," ",(0,a.jsx)("a",{href:"https://s3.filebase.com/ipfs/".concat(ey),target:"_blank",rel:"noopener noreferrer",className:"underline text-blue-500",title:"View receipt on IPFS",children:"View on IPFS"})]}):"confirmed"===em?(0,a.jsx)("p",{className:"italic text-gray-400",children:"Receipt generation pending…"}):"failed"===em?(0,a.jsx)("p",{className:"text-red-500",children:"Transaction failed. Please try again or contact support."}):(0,a.jsx)("p",{className:"italic text-gray-400",children:"Awaiting transaction status…"})]})]})]})]})},F=e=>{let{title:t,onClose:n,children:s}=e;return(0,i.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n]),(0,a.jsx)("div",{className:"fixed inset-0 z-100 flex items-center justify-center bg-black/50",children:(0,a.jsxs)("div",{className:"bg-base-100 w-full max-w-200 max-h-[90vh] rounded-lg shadow-xl border border-base-300 p-4 overflow-hidden relative animate-fadeIn",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[t&&(0,a.jsx)("h3",{className:"text-lg font-semibold text-info",children:t}),(0,a.jsx)("button",{onClick:n,className:"btn btn-sm btn-ghost border-none outline-none text-lg text-info hover:bg-base-300",children:"✕"})]}),(0,a.jsx)("div",{className:"overflow-y-auto max-h-[70vh] pr-1 custom-scrollbar",children:s})]})})};var W=n(73146);let H={USD:"USDC",EUR:"EURC",USDT:"USDT",DAI:"DAI",GBP:"GBPT",JPY:"JPYC",CAD:"QCAD",AUD:"AUDD",BRL:"BRL1",CHF:"XCHF",INR:"INRX",SGD:"XSGD",ZAR:"ZARP",KRW:"KRT",MXN:"MMXN",PYUSD:"PYUSD",FDUSD:"FDUSD",NGN:"NGNT",ARS:"ARSX",TRY:"TRYX"},Y={eseries:{epanel:[{label:"120v Split Phase @60Hz",apriceInUSD:BigInt(0)},{label:"Customize",apriceInUSD:BigInt(1e9)}],monitoring:[{label:"No Monitoring",apriceInUSD:BigInt(0)},{label:"Monitoring",apriceInUSD:BigInt(2e9)}],etie:[{label:"Stand Alone",apriceInUSD:BigInt(0)},{label:"Grid Tie",apriceInUSD:BigInt(1e9)}]},xseries:{xpanel:[{label:"360v 3 Phase @60Hz",apriceInUSD:BigInt(0)},{label:"Customize",apriceInUSD:BigInt(5e9)}],monitoring:[{label:"No Monitoring",apriceInUSD:BigInt(0)},{label:"Monitoring",apriceInUSD:BigInt(2e9)}],xtie:[{label:"Stand Alone",apriceInUSD:BigInt(0)},{label:"Grid Tie",apriceInUSD:BigInt(5e9)}]}},G=e=>{let{data:t}=e,{asset:n,metadata:s}=t,r=Y[n.variant];Object.keys(H);let[l,o]=(0,i.useState)({}),[d,u]=(0,i.useState)("USD"),[p,y]=(0,i.useState)("crypto"),[x,h]=(0,i.useState)("native"),[f,b]=(0,i.useState)("USDC"),[g,v]=(0,i.useState)(0),[j,T]=(0,i.useState)(1),[w,N]=(0,i.useState)(s.image),[D,I]=(0,i.useState)(!1),[S,C]=(0,i.useState)(!1),[k,U]=(0,i.useState)(!1),P=c(e=>e.setField);(0,i.useEffect)(()=>{let e={};Object.entries(r).forEach(t=>{let[n,a]=t;e[n]=a[0]}),o(e)},[n.variant]);let E=(0,i.useMemo)(()=>{let e=Object.values(l).reduce((e,t)=>e+t.apriceInUSD,BigInt(0));return Number(BigInt(n.basePriceInUSD)+e)/1e6},[n.basePriceInUSD,l]);(0,i.useEffect)(()=>{v(E*(m[d]||1))},[E,d]),(0,i.useEffect)(()=>{let e="cash"===p?null:"native"===x?"GBDO":f;P("quantity",j),P("tokenSymbol",e||""),P("estimatedTotal",(g*j).toString()),P("estimatedEscrow",(g*j/2).toString()),P("paymentMethod","cash"===p?"cash":x)},[n,j,d,g,p,x,f]);let M=n.baseDays+(j-1)*Number(n.perUnitDelay);return(0,a.jsxs)("div",{className:"bg-base-100 rounded-xl shadow-md p-4 flex flex-col space-y-4",children:[s.image&&(0,a.jsx)("img",{src:"https://ipfs.io/ipfs/".concat(w),alt:"Product",onMouseEnter:()=>N(s.altImage||s.image),onMouseLeave:()=>N(s.image),className:"rounded-lg h-40 object-cover transition-transform duration-200 hover:scale-105"}),(0,a.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-md font-light",children:s.name}),(0,a.jsx)("p",{className:"text-xs text-info-400",children:s.model})]}),(0,a.jsx)("button",{onClick:()=>C(!0),className:"btn btn-ghost border-none outline-none btn-sm text-info hover:bg-base-300",children:"Description ▸"})]}),(0,a.jsxs)("p",{className:"text-md font-medium",children:[g.toFixed(2)," ",d]}),(0,a.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>T(e=>Math.max(1,e-1)),className:"btn btn-xs",children:"–"}),(0,a.jsx)("span",{className:"font-medium",children:j}),(0,a.jsx)("button",{onClick:()=>T(e=>e+1),className:"btn btn-xs",children:"+"})]}),(0,a.jsx)("button",{className:"btn text-base-200 text-light btn-white w-full",onClick:()=>I(!0),children:"CHECKOUT"}),S&&(0,a.jsx)(F,{title:"Product Description",onClose:()=>C(!1),children:(0,a.jsx)("div",{className:"max-h-200 max-w-400 overflow-y-auto whitespace-pre-line text-sm mb-8 px-1",children:(s.description||"").split("|||").map((e,t)=>(0,a.jsx)("p",{className:"mb-3",children:e},t))})}),D&&(0,a.jsx)(B,{asset:{assetId:n.assetId,name:s.name||"Unnamed Asset"},selectedCurrency:d,variationGroups:r,selectedVariations:l,setSelectedVariations:o,onClose:()=>I(!1),openWalletModal:()=>U(!0)}),k&&(0,a.jsx)(W.o,{isOpen:k,onClose:()=>U(!1)}),(0,a.jsxs)("p",{className:"text-sm text-light text-gray-500 text-center",children:["Lead Time: ",M," day",1===M?"":"s"]})]})}},75218:(e,t,n)=>{n.d(t,{a:()=>i});var a=n(95155);n(12115);let i=e=>{let{title:t,children:n,onClose:i,isOpen:s}=e;return s?(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"bg-base-100 rounded-xl shadow-lg w-full max-w-md p-6 relative",style:{maxWidth:"550px"},children:[(0,a.jsx)("button",{onClick:i,className:"absolute top-2 right-3 mt-3 btn btn-sm btn-ghost border-none outline-none text-lg text-info hover:bg-base-300","aria-label":"Close Modal",children:"\xd7"}),t&&(0,a.jsx)("h3",{className:"text-lg font-light mx-6 mb-4 text-primary",children:t}),n]})}):null}},87981:(e,t,n)=>{n.d(t,{D:()=>j});var a=n(95155),i=n(12115),s=n(73703),r=n(75218),l=n(11580),o=n(38227),d=n(32064),c=n(94524),u=n(2145),p=n(65996),m=n(68183),y=n(14493);async function x(e){let{txhash:t="",userOpHash:n="",useraddress:a,amount:i,committedQuarters:s,tokenSymbol:r,tokenDecimals:l,status:o,chainstatus:d,notes:c=null,processedat:u=null}=e;return fetch("/api/queue/txlog",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:"deposit",txhash:t,userOpHash:n,useraddress:a,fromtoken:r,totoken:"GBD",amountin:"bigint"==typeof i?i.toString():i,amountout:"0",status:o,chainstatus:d,timestamp:new Date().toISOString(),queuedat:new Date().toISOString(),processedat:u,priority:1,retrycount:0,notes:c})})}let h=JSON.parse('{"H":[{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"previousAdmin","type":"address"},{"indexed":false,"internalType":"address","name":"newAdmin","type":"address"}],"name":"AdminChanged","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"beacon","type":"address"}],"name":"BeaconUpgraded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"investment","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"products","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"redemptions","type":"uint256"}],"name":"CapitalAllocated","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"target","type":"address"},{"indexed":false,"internalType":"uint128","name":"amount","type":"uint128"},{"indexed":false,"internalType":"string","name":"purpose","type":"string"}],"name":"CapitalSpent","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint256","name":"reward","type":"uint256"}],"name":"Claimed","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint128","name":"amount","type":"uint128"},{"indexed":false,"internalType":"uint32","name":"committedQuarters","type":"uint32"}],"name":"Deposited","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"id","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"totalProfit","type":"uint256"}],"name":"Distributed","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint8","name":"version","type":"uint8"}],"name":"Initialized","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":false,"internalType":"uint128","name":"amount","type":"uint128"}],"name":"ProfitAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint32","name":"newQuartersCommitted","type":"uint32"}],"name":"Recommitted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"implementation","type":"address"}],"name":"Upgraded","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"user","type":"address"},{"indexed":false,"internalType":"uint128","name":"amount","type":"uint128"}],"name":"Withdrawn","type":"event"},{"inputs":[],"name":"currentDistributionId","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint128","name":"amount","type":"uint128"},{"internalType":"uint32","name":"committedQuarters","type":"uint32"}],"name":"deposit","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"distributionProfits","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserDepositStatus","outputs":[{"internalType":"uint256","name":"depositAmount","type":"uint256"},{"internalType":"uint256","name":"depositStartTime","type":"uint256"},{"internalType":"uint256","name":"elapsedDays","type":"uint256"},{"internalType":"uint256","name":"remainingDays","type":"uint256"},{"internalType":"bool","name":"isPending","type":"bool"},{"internalType":"bool","name":"isClosed","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserVaultInfo","outputs":[{"internalType":"uint128","name":"amount","type":"uint128"},{"internalType":"uint32","name":"committedQuarters","type":"uint32"},{"internalType":"uint32","name":"unlockQuarter","type":"uint32"},{"internalType":"uint256[]","name":"redemptionIds","type":"uint256[]"},{"components":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint128","name":"amount","type":"uint128"},{"internalType":"uint32","name":"requestQuarter","type":"uint32"},{"internalType":"bool","name":"fulfilled","type":"bool"}],"internalType":"struct SmartVaultLib.Redemption[]","name":"redemptions","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"hasLockedRedemption","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_owner","type":"address"},{"internalType":"address","name":"_stableToken","type":"address"},{"internalType":"address","name":"_seedNode","type":"address"}],"name":"initialize","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"investmentReserve","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"productReserve","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"proxiableUUID","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint32","name":"additionalQuarters","type":"uint32"}],"name":"recommit","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"redemptionQueue","outputs":[{"internalType":"address","name":"user","type":"address"},{"internalType":"uint128","name":"amount","type":"uint128"},{"internalType":"uint32","name":"requestQuarter","type":"uint32"},{"internalType":"bool","name":"fulfilled","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"redemptionReserve","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"seedNode","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"stableToken","outputs":[{"internalType":"contract IERC20Upgradeable","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalDeposits","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"totalProfits","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newImplementation","type":"address"}],"name":"upgradeTo","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newImplementation","type":"address"},{"internalType":"bytes","name":"data","type":"bytes"}],"name":"upgradeToAndCall","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"userRedemptionIds","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"users","outputs":[{"internalType":"uint128","name":"amount","type":"uint128"},{"internalType":"uint64","name":"depositTime","type":"uint64"},{"internalType":"uint64","name":"claimedDistribution","type":"uint64"},{"internalType":"uint32","name":"recommitCount","type":"uint32"},{"internalType":"uint32","name":"eligibleQuarter","type":"uint32"},{"internalType":"uint32","name":"committedQuarters","type":"uint32"},{"internalType":"uint32","name":"unlockQuarter","type":"uint32"}],"stateMutability":"view","type":"function"}]}');var f=n(23091),b=n(20482),g=n(13568),v=n(21571);let j=e=>{let{amount:t,committedQuarters:n,token:j,isOpen:D,onClose:I,openWalletModal:S}=e;if(!D)return null;let[C,k]=(0,i.useState)(1),[U,P]=(0,i.useState)(!1),[E,M]=(0,i.useState)(!1),[A,O]=(0,i.useState)(null),[L,R]=(0,i.useState)(null),[B,F]=(0,i.useState)(""),[W,H]=(0,i.useState)(""),{address:Y}=(0,u.F)(),G=(0,p.e)(),{chain:Q}=(0,u.F)();null==Q||Q.id;let{writeContractAsync:V}=(0,m.x)(),{smartAccountClient:q,isInitializing:K}=(0,v.y)();(0,o.l)({chain:l.J,transport:(0,d.L)()});let z=async()=>{if(!G||!Y)return void alert("Wallet or RPC not available.");try{let e=await G.readContract({address:j.address,abi:y.xw,functionName:"balanceOf",args:[Y]});if(!(BigInt(e)>=t))return void alert("Insufficient ".concat(j.symbol," balance."));k(5)}catch(e){console.error("Fund verification failed:",e),alert("Unable to verify your funds. Please try again shortly.")}};return(0,i.useEffect)(()=>{fetch("/legal/investorOverview.txt").then(e=>e.text()).then(F),fetch("/legal/privacy-policy.txt").then(e=>e.text()).then(H)},[]),(0,i.useEffect)(()=>{if(3===C)try{var e,t;let a=Date.now()/1e3,i=T(a)+n,s=function(e,t){let n=T(e),a=function(e){let t=new Date(1e3*e),n=t.getFullYear(),a=Math.floor(t.getMonth()/3);return Math.floor(new Date(n,3*a,1).getTime()/1e3)}(e);return(e-a)/86400<=20*(t>=3)?n:n+1}(a,n),r=w(i),l=w(s);O({unlockQ:i,eligibilityQ:s,multiplier:(e=0,(t=n)>=6?200:t>=4?150:125),unlockLabel:N(r),eligibilityLabel:N(l)})}catch(e){console.error("Error in step 3 useEffect:",e)}},[C,n]),(0,i.useEffect)(()=>{let e=!1,a=5===C,i=!!Y,{smartAccountClient:r,isInitializing:l}=(0,v.y)();return a&&(!i||l)?void R(""):5===C&&!L&&G&&r?((async()=>{var a,i;let l=await r;if(!l)return R("");try{let i=!0;try{await G.getBlockNumber()}catch(e){i=!1}if(!Y)throw Error("Wallet not connected");let r=await G.readContract({address:j.address,abi:y.xw,functionName:"balanceOf",args:[Y]});if(BigInt(r)<t)return void g.oR.error("Insufficient token balance.");let o=f.SmartVault;if(!o)throw Error("Vault contract not found");let d=new s.KA(h.H).encodeFunctionData("deposit",[t,n]),u={to:o,data:d,value:(0,c.g)(t.toString())},p=await l.sendTransaction(u),m=p.userOpHash;if(!i){await x({txhash:"",userOpHash:m,useraddress:Y,amount:t,committedQuarters:n,tokenSymbol:j.symbol,tokenDecimals:j.decimals,status:"queued",chainstatus:!1,notes:"RPC unavailable, intent captured"}),g.oR.error("Chain unavailable. Deposit will be retried.");return}let b=await p.waitForTxHash(),v=null!=(a=null==b?void 0:b.transactionHash)?a:"";e||(R(v),k(5),await x({txhash:v,userOpHash:m,useraddress:Y,amount:t,committedQuarters:n,tokenSymbol:j.symbol,tokenDecimals:j.decimals,status:"finalized",chainstatus:!0,processedat:new Date().toISOString()}),g.oR.success("Deposit finalized successfully!"))}catch(a){console.warn("Deposit error:",a),e||(await x({txhash:"",userOpHash:"",useraddress:Y,amount:t,committedQuarters:n,tokenSymbol:j.symbol,tokenDecimals:j.decimals,status:"queued",chainstatus:!1,notes:null!=(i=a.message)?i:"Deposit fallback triggered"}),g.oR.error("Deposit failed. Will retry when chain is healthy."))}})(),()=>{e=!0}):void 0},[C,L,Y,G,t,j,q]),(0,a.jsxs)(r.a,{isOpen:!0,onClose:I,title:"",children:[(0,a.jsx)("div",{className:"flex justify-between text-xs mt-15 mb-6 px-2",children:["Terms","Policy","Review","Confirm","Done"].map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"w-4 h-4 rounded-full border-1 mb-6 ".concat(C>t?"bg-info border-info":C===t?"bg-secondary border-info":"border-gray-400")}),(0,a.jsx)("span",{className:"".concat(C===t?"font-light text-info":"text-gray-500"),children:e})]},e))}),(0,a.jsxs)("div",{className:"space-y-2 h-[600px] flex flex-col",children:[1===C&&(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 space-y-6",children:[(0,a.jsx)("h3",{className:"text-lg font-light",children:"INVESTMENT TERMS"}),(0,a.jsx)("div",{className:"max-h-[400px] overflow-y-auto text-sm border p-3 rounded bg-black text-justify text-info-300",children:B||"Loading…"}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("input",{type:"checkbox",checked:U,onChange:()=>P(!U)}),"I agree to the Investment Terms"]})]}),(0,a.jsx)("div",{className:"flex justify-end gap-2 p-4 border-t bg-transparent",children:(0,a.jsx)("button",{className:"btn btn-primary text-base-200 btn-sm",onClick:()=>{U&&k(2)},disabled:!U,children:"Next"})})]}),2===C&&(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 space-y-6",children:[(0,a.jsx)("h3",{className:"text-lg font-light",children:"PRIVACY POLICY"}),(0,a.jsx)("div",{className:"max-h-[400px] overflow-y-auto text-sm border p-3 rounded bg-black text-justify text-info-300",children:W||"Loading…"}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("input",{type:"checkbox",checked:E,onChange:()=>M(!E)}),"I agree to the Privacy Policy"]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 p-4 border-t bg-transparent",children:[(0,a.jsx)("button",{className:"btn btn-secondary text-base-200 btn-sm",onClick:()=>k(e=>Math.max(e-1,1)),children:"Previous"}),(0,a.jsx)("button",{className:"btn btn-primary text-base-200 btn-sm",onClick:()=>{E&&k(3)},disabled:!E,children:"Next"})]})]}),3===C&&A&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{className:"font-light",children:"SMART CONTRACT SUMMARY"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 divide-y divide-base-300 h-[500px] overflow-y-auto p-2 text-sm",children:[(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsx)("p",{className:"text-base font-light",children:"INVESTMENT AMOUNT"}),(0,a.jsx)("p",{children:(0,a.jsxs)("strong",{children:[Number(t)/10**j.decimals," ",j.symbol]})})]}),(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsx)("p",{className:"text-base font-light",children:"QUARTERS TO INVEST"}),(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:n})})]}),(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsx)("p",{className:"text-base font-light",children:"INVESTMENT UNLOCK QUARTER"}),(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:null==A?void 0:A.unlockLabel})})]}),(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsx)("p",{className:"text-base font-light",children:"INVESTMENT ELIGIBILITY QUARTER"}),(0,a.jsx)("p",{children:(0,a.jsx)("strong",{children:null==A?void 0:A.eligibilityLabel})})]}),(0,a.jsxs)("div",{className:"py-1",children:[(0,a.jsx)("p",{className:"text-base font-light",children:"INVESTMENT MULTIPLIER"}),(0,a.jsx)("p",{children:(0,a.jsxs)("strong",{children:[null==A?void 0:A.multiplier,"%"]})})]})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center p-4 border-t bg-transparent",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.g_,{}),!Y&&(0,a.jsx)("span",{className:"text-red-500 text-sm",children:"Wallet required"})]}),(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)("button",{className:"btn btn-secondary text-base-200 btn-sm",onClick:()=>k(2),children:"Back"}),(0,a.jsx)("button",{className:"btn btn-primary text-base-200 btn-sm",onClick:()=>k(4),disabled:!Y,children:"Next"})]})]})]}),4===C&&(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 space-y-6",children:[(0,a.jsx)("h3",{className:"text-lg font-light",children:"COMMIT"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("p",{children:["Investment Total: ",(0,a.jsxs)("strong",{children:[Number(t)/10**j.decimals," ",j.symbol]})]}),(0,a.jsxs)("p",{children:["Investment Unlock Quarter: ",(0,a.jsx)("strong",{children:null==A?void 0:A.unlockLabel})]})]}),(0,a.jsxs)("p",{className:"text-sm text-justify text-info-300",children:["This transaction is irreversible and your investment and any rewards ",(0,a.jsx)("strong",{children:'"will not"'})," be available until you have reached your ",(0,a.jsx)("strong",{children:'"Invest Unlock Quarter"'}),". By clicking confirm you consent to invest the total stated above, including the conditions outlined in the investment process."]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 p-4 border-t bg-transparent",children:[(0,a.jsx)("button",{className:"btn btn-secondary text-base-200 btn-sm",onClick:()=>k(3),children:"Back"}),(0,a.jsx)("button",{className:"btn btn-primary text-base-200 btn-sm",onClick:z,children:"Confirm"})]})]}),5===C&&L&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{className:"font-semibold",children:"Investment Confirmed"}),(0,a.jsxs)("p",{className:"flex-1",children:["View tx:"," ",(0,a.jsxs)("a",{href:"https://etherscan.io/tx/".concat(L),target:"_blank",className:"underline text-blue-500",children:[L.slice(0,10),"…"]})]})]})]})]})};function T(e){let t=new Date(1e3*e);return 4*t.getFullYear()+Math.floor(t.getMonth()/3)}function w(e){return new Date(Math.floor(e/4),e%4*3,1)}function N(e){let t=e.getFullYear(),n=Math.floor(e.getMonth()/3)+1;return"Q".concat(n," ").concat(t)}}}]);